## auxiliary functions for sparse setting
